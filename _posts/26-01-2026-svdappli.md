---
layout: post
title: Singular Value Decomposition for Hyperspectral Image Dimensionality Reduction
date: 2025-01-12
description: Dimensionality reduction of the Indian Pines hyperspectral dataset using Singular Value Decomposition (SVD)
tags: linear-algebra svd hyperspectral dimensionality-reduction
categories: sample-posts
thumbnail: assets/img/SVD/indianpines.jpg
---

## Introduction and Objective

Hyperspectral images contain rich spectral information across hundreds of wavelength bands, making them highly informative but also computationally expensive to store and process. Dimensionality reduction techniques are therefore essential for efficient analysis and visualization.

In this work, **Singular Value Decomposition (SVD)** is applied to the well-known **Indian Pines hyperspectral dataset** to explore its structure and reduce its dimensionality while preserving most of the informative content. The main objective is to analyze the dataset, perform dimensionality reduction, and evaluate reconstruction quality.

---

## Problem Statement

Given the MATLAB file `indian_pines.mat`, the following tasks are performed:

1. Load the hyperspectral data and visualize it in RGB format
2. Generate a false-color image and analyze the spectral profile of a selected pixel
3. Compute the total number of elements required to store the dataset
4. Reshape the 3D hyperspectral cube into a 2D matrix
5. Apply Singular Value Decomposition (SVD)
6. Analyze cumulative explained variance and select an appropriate reconstruction rank
7. Reconstruct the dataset using truncated SVD
8. Compute dimensionality reduction percentage and reconstruction error (RMSE)

---

## Methodology

All computations and visualizations were performed using **MATLAB**.

### Loading and Visualization

The hyperspectral image cube is loaded and visualized in RGB format. A false-color image is created by selecting specific spectral bands and applying contrast stretching. Pixel-level spectral behavior is analyzed, and the 3D data cube is reshaped into a 2D matrix using MATLAB’s built-in `reshape()` function.

---

### Singular Value Decomposition

After reshaping, Singular Value Decomposition is applied:

$$
\mathbf{X} = \mathbf{U}\mathbf{S}\mathbf{V}^\top
$$

The cumulative explained variance (CV) is computed as:

$$
\text{CV} = \text{cumsum}(EV),
\quad \text{where} \quad
EV = \frac{\sigma_i^2}{\sum_i \sigma_i^2}
$$

Here, $\sigma_i$ represents the singular values contained in the diagonal matrix $\mathbf{S}$. The reconstruction rank is selected based on the desired variance threshold.

---

### Dimensionality and Error Analysis

Using truncated SVD components, the dataset is reconstructed. The reduced dimensionality is computed as:

$$
\text{Dim}_{\text{reduced}} = \text{elements}(U_k S_k) + \text{elements}(V_k)
$$

The percentage reduction in dimensionality and the **Root Mean Squared Error (RMSE)** between the original and reconstructed datasets are used to quantify performance.

---

## Results

### Image Loading, Properties, and Visualization

<div class="row mt-3">
  <div class="col-sm mt-3 mt-md-0">
    {% include figure.liquid path="assets/img/ADML/img1.png" class="img-fluid rounded z-depth-1" zoomable=true %}
  </div>
  <div class="col-sm mt-3 mt-md-0">
    {% include figure.liquid path="assets/img/ADML/img2.png" class="img-fluid rounded z-depth-1" zoomable=true %}
  </div>
</div>

The left image shows the RGB visualization, while the right image presents a false-color representation with contrast stretching.

**Dataset properties:**

Hypercube:
DataCube: [145 × 145 × 220 double]
Wavelength: [220 × 1 double]
Metadata: struct

---

### Spectral Profile of a Pixel

A pixel located at **row 60, column 70** was selected to analyze its spectral behavior.

<div class="row mt-3">
  <div class="col-sm mt-3 mt-md-0">
    {% include figure.liquid path="assets/img/ADML/img3.png" class="img-fluid rounded z-depth-1" zoomable=true %}
  </div>
</div>

The spectral profile indicates a significantly higher intensity around wavelength index 50 for this pixel.

---

### Data Reshaping and Storage Analysis

The total number of elements required to store the hyperspectral cube is:

$$
145 \times 145 \times 220 = 4{,}625{,}500
$$

The 3D matrix is reshaped into a 2D matrix of size:

$$
(145 \times 145) \times 220 = 21{,}025 \times 220
$$

---

### SVD, Dimensionality Reduction, and Error Analysis

<div class="row mt-3">
  <div class="col-sm mt-3 mt-md-0">
    {% include figure.liquid path="assets/img/ADML/img5.png" class="img-fluid rounded z-depth-1" zoomable=true %}
  </div>
</div>

The cumulative explained variance increases rapidly, indicating that a **small number of singular values capture most of the information**. Remarkably, **99% of the variance is captured with rank = 2**, resulting in a dimensionality reduction of approximately **96.35%**.

---

### Reconstructed Image

<div class="row mt-3">
  <div class="col-sm mt-3 mt-md-0">
    {% include figure.liquid path="assets/img/ADML/img4.png" class="img-fluid rounded z-depth-1" zoomable=true %}
  </div>
</div>

The reconstructed image retains nearly all structural information while using only a fraction of the original data dimensions.

---

## Discussion

This experiment highlights the effectiveness of Singular Value Decomposition for hyperspectral image analysis. Despite the high dimensionality of the Indian Pines dataset, only a very low-rank approximation is required to preserve most of the information.

Key observations include:

- Rapid growth of cumulative explained variance
- Significant reduction in storage requirements
- High-quality reconstruction with minimal loss

---

## Final Remarks

Singular Value Decomposition proves to be a powerful and interpretable tool for dimensionality reduction in hyperspectral imaging. Its ability to compress data while preserving essential information makes it suitable for preprocessing, visualization, and further machine learning tasks.

Future extensions may include:

- PCA comparison
- noise robustness analysis
- band selection strategies
- integration with classification models

---

_Code and figures related to this analysis are available in the accompanying repository._
